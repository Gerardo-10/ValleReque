from src.models.entities.Terreno import Terreno


class ModelTerreno:
    @classmethod
    def get_by_id(cls, db, id_terreno):
        try:
            cursor = db.connection.cursor()
            cursor.execute("CALL sp_obtener_terreno(%s)", (id_terreno,))
            row = cursor.fetchone()

            # Liberar el resto del resultado del procedimiento si existe
            while cursor.nextset():
                pass

            if row is not None:
                terreno = Terreno(*row)
                return terreno
            return None
        except Exception as e:
            print(f"[ERROR get_by_id terreno {id_terreno}]: {e}")
            return None

    @classmethod
    def get_all(cls, db):
        try:
            cursor = db.connection.cursor()
            cursor.execute("CALL sp_listar_terrenos()")
            rows = cursor.fetchall()

            # Liberar el resto del resultado del procedimiento si existe
            while cursor.nextset():
                pass

            terrenos = [Terreno(*row) for row in rows]
            return terrenos
        except Exception as e:
            print(f"[ERROR get_all terreno]: {e}")
            return []