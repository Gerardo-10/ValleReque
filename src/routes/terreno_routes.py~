from flask import Blueprint, render_template, current_app
from flask_login import login_required

from src.models.ModelProyecto import ModelProyecto
from src.models.ModelTerreno import ModelTerreno
from src.routes.proyecto_routes import proyectos

terreno_routes = Blueprint('terreno_routes', __name__)

@terreno_routes.route('/terrenos')
@login_required
def terrenos():
    terreno = ModelTerreno.get_all(current_app.db)
    proyecto = ModelProyecto.get_all(current_app.db)

    # Crear diccionario: id_proyecto -> nombre
    proyectos_dict = {proy.id_proyecto: proy.nombre for proy in proyectos}

    # Agregar nombre del proyecto a cada terreno
    for terreno in terrenos:
        terreno.nombre_proyecto = proyectos_dict.get(terreno.id_proyecto, 'Sin Proyecto')

    return render_template('logistica/terrenos.html', terrenos=terrenos)
